\section{Photochemistry solver}

The photochemical solving solves the diffusion and the chemistry, thus we solve:
\begin{equation}
\doverd{\conc_s}{t} = \left(\doverd{\conc_s}{t}\right)_\text{diff} + \left(\doverd{\conc_s}{t}\right)_\text{kin}
\end{equation}
and we develop thanks to equations~\ref{Titan:diffusion} and \ref{Titan:kinetics}
\begin{equation}
\begin{split}
\left(\doverd{\conc_s}{t}\right) & = \sum_{r\in \text{reactions}} \stoi{s,r}\rate_{r} \prod_{i\in\text{reactants}}\conc_i^{|\stoi{i,r}|} +
                                     \frac{1}{r^2}\doverd{\left(r^2\conc_s\omega_s\right)}{r} \\
                                 & = \sum_{r\in \text{reactions}} \stoi{s,r} \rate_r\prod_{i\in\text{reactants}}\conc_i^{|\stoi{i,r}|} +
                                     \frac{1}{r^2}\doverd{\left(r^2\right)}{r} + \frac{1}{r^2}\doverd{\left(\conc_s\omega_s\right)}{r} \\
                                 & = \sum_{r\in \text{reactions}} \stoi{s,r} \rate_{r}\prod_{i\in\text{reactants}}\conc_i^{|\stoi{i,r}|} +
                                     \frac{2}{r} + \frac{1}{r^2}\doverd{\left(\conc_s\omega_s\right)}{r} \\
\end{split}
\end{equation}
