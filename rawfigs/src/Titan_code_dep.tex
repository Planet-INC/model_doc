\documentclass{article}
\usepackage{tikz,geometry}
\usetikzlibrary{trees,backgrounds,calc,fit}
\geometry{
paperwidth=28cm,paperheight=13.5cm,
left=0pt,right=0pt,top=3pt,bottom=0pt}
\begin{document}
\centering
\tikzset{
limit/.style={ultra thick, loosely dashed, gray!50},
round/.style={rounded corners=5mm,red}
}
\begin{tikzpicture}[every node/.append style={anchor=base}]%,fill=white,opacity=0.8}]
\node (PPH) at (0,0) {PlanetPhysicsHelper} [grow'=up]
        child[sibling distance=4cm] {
                        node (omegadot) {$\dot{n}(z)$} edge from parent[stealth-] 
                child {
                node (kin) {kinetics} [sibling distance=3.2cm] edge from parent[-] 
                        child {
                                 node (neukineval) {kinetics evaluator}
                                         child {
                                                  node (neureac) {reaction set}
                                                        child {
                                                                 node (neucomp) {neutral composition}
                                                              }
                                               }
                              }
                        child {
                                 node (ionkineval) {kinetics evaluator}
                                         child {
                                                  node (ionreac) {reaction set}
                                                        child {
                                                                 node (ioncomp) {ionic composition}
                                                              }
                                               }
                              }
                     }
              }
        child[sibling distance = 3cm,draw=white] {
                child {
                child {
                node (hvfeval) {Photon evaluator}
                           child [draw=black]{
                             node (hvtau) {photon opacity}
                                child {
                                         node (chap){Chapman}
                                      }
                                             }
                     }
                     }
              } 
        child[sibling distance=3.5cm,draw=white] 
              {
                child{
                child{
                child {node (atmmix) {atmospheric mixture}}
                }
                }
              }
        child[sibling distance=3cm,draw=white] { 
                child { 
                child { 
                child { 
                        child  { 
                              node (temp) {temperature}
                                }
                      }
                      }
                      }
               }
        child[sibling distance=4cm]{
                        node (omega) {$\omega(z)$}edge from parent[stealth-] 
          child {
                node (diff) {diffusion}edge from parent[-] 
                 [sibling distance=3cm]
                  child {
                           node (moldiff) {molecular diffusion} child {
                                                                child {
                                                                node (bindiff) {binary diffusion}
                                                                      }
                                                                      }
                        }
                  child {
                           node (eddy) {eddy diffusion}
                        }
              }
              }
;
\coordinate (gauche) at (current bounding box.west);
\coordinate (droite) at (current bounding box.east);
\coordinate (l1)     at ($(ioncomp.south)!0.5!(ionreac.north)$);
\coordinate (l2)     at ($(ionreac.south)!0.5!(ionkineval.north)$);
\coordinate (l3)     at ($(ionkineval.south)!0.5!(kin.north)$);
\draw[round] (temp) -| (atmmix);
\draw[round] (temp) |- (moldiff);
\draw[round] (temp) |- (diff);
\draw[round] (atmmix) |- (hvfeval);
\draw[round] (atmmix) -| (moldiff);
\draw[round] (atmmix) -| (eddy);
\draw[round] (atmmix) |- (diff);
\draw[round] (ioncomp) |- ($(chap.south)!0.3!(hvtau.north)$) -| (atmmix);
\draw[round] (neucomp) |- ($(chap.south)!0.5!(hvtau.north)$) -| (atmmix);
\draw[round] (hvfeval) |- (kin);
\begin{pgfonlayer}{background}
\node[fit= (neucomp) (ioncomp) (neukineval) (ionkineval),rounded corners=1cm,inner sep=5pt,fill=gray!30] {\null};
\foreach \level in {1,...,3}
  \draw[limit] ( gauche |- l\level)  -- (l\level -| droite);
\end{pgfonlayer}
\node (PP) at ([yshift=-2cm]PPH.south)   {PlanetPhysics};
\node (grins) at ([yshift=-2cm]PP.south) {GRINS};
\draw[stealth-stealth] (PPH) -- (PP);
\draw[-stealth] (grins) -- (PP)node[pos=0.5,fill=white]{$z$};
\end{tikzpicture}
\end{document}
